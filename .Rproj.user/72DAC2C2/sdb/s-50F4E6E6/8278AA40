{
    "contents" : "xr <- seq(min(zmat[,i]), max(zmat[, i]), length = 50)\nyr <- seq(min(zmat[,j]), max(zmat[, j]), length = 50)\nslice<-lapply(zmat, median)\nmod_obj<-svm(as.formula(paste(names(wmat)[k+1],\"~ .\")), data = wmat, kernel = \"linear\")\nformala<-as.formula(paste(names(zmat)[i], \"~\", names(zmat)[j]))\nlis <- c(list(yr), list(xr), slice)\nnames(lis)[1:2] <- colnames(wmat)[c(i,j)]\nnew <- expand.grid(lis)[, labels(terms(mod_obj))]\npreds <- predict(mod_obj, new)\ncoords = dimensions\nk = length(wmat[1, ]) - 1\nn = length(wmat[, 1])\nzmat = wmat[, 1:k]\nindi = wmat[, (k + 1)]\nnumg = max(as.numeric(indi)) ###add as.numeric()\nssgroup = rep(0, numg)\nfor (p in 1:numg) {\n  see = wmat[indi == levels(indi)[p], ]\n  ssgroup[p] = length(see[, 1])\n}\nxl = c(min(zmat), max(zmat))\nyl = c(min(zmat), max(zmat))\nnewindi <- order(indi)\nz1 <- zmat[, coords[i]]\nz2 <- zmat[, coords[j]]\nzz1 <- z1[newindi]\nzz2 <- z2[newindi]\nplot(zz2, zz1, xlab = \"\", ylab = \"\", pch = \" \",\n     xlim = xl, ylim = yl, axes = FALSE)\n\n.filled.contour(xr, \n                yr, \n                matrix(as.numeric(preds),nrow = length(xr), byrow = TRUE),\n                levels = 1:length(levels(preds))+1,\n                col=colorpanel(3, low = \"grey70\", high = \"black\"))\n\nic <- 0\ncoli <- 0\nfor (p in 1:numg) {\n  there <- 0\n  for (m in 1:length(groups)) {\n    if (groups[m] == p) {\n      there <- 1\n      break\n    }\n  }\n  start <- ic + 1\n  stop <- ic + ssgroup[p]\n  coli <- coli + 1\n  if (there == 1) {\n    points(zz2[start:stop], zz1[start:stop],\n           col = colors[p], pch = gsymbols[p])\n    abline(lsfit(zz2[start:stop], zz1[start:stop]),\n           col = colors[p])\n    there <- 0\n  }\n  \n  ic <- ic + ssgroup[p]\n }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nxr <- seq(min(zmat[,i]), max(zmat[, i]), length = 50)\nyr <- seq(min(zmat[,j]), max(zmat[, j]), length = 50)\n\nif(build_svm==TRUE){\n  coords = dimensions\n  k = length(wmat[1, ]) - 1\n  n = length(wmat[, 1])\n  zmat = wmat[, 1:k]\n  xr <- seq(min(zmat[,i]), max(zmat[, i]), length = 50)\n  yr <- seq(min(zmat[,j]), max(zmat[, j]), length = 50)\n  slice<-lapply(zmat, median)\n  mod_obj<-svm(as.formula(paste(names(wmat)[k+1],\"~ .\")), data = wmat, kernel = \"linear\")\n  formala<-as.formula(paste(names(zmat)[i], \"~\", names(zmat)[j]))\n  #par(new = TRUE)\n  lis <- c(list(yr), list(xr), slice)\n  names(lis)[1:2] <- colnames(wmat)[c(i,j)]\n  new <- expand.grid(lis)[, labels(terms(mod_obj))]\n  preds <- predict(mod_obj, new)\n  filled.contour(xr, yr, matrix(as.numeric(preds),\n                                nrow = length(xr), byrow = TRUE), plot.axes = {\n                                  #axis(1)\n                                  #axis(2)\n                                  colind <- as.numeric(model.response(model.frame(mod_obj, wmat)))\n                                  dat1 <- wmat[-mod_obj$index, ]\n                                  dat2 <- wmat[mod_obj$index, ]\n                                  coltmp1 <- palette()[colind[-mod_obj$index]]\n                                  coltmp2 <- palette()[colind[mod_obj$index]]\n                                  #points(formala, data = dat1, pch = 21,\n                                  #       col = \"black\")\n                                  #points(formala, data = dat2, pch = 19,\n                                  #       col = \"red\")\n                                }, levels = 1:(length(levels(preds)) + 1))\n  \n\n                levels = 1:(length(levels(preds)) + 1),\n                color.palette = cm.colors,\n                col = color.palette(length(levels) - 1))\n                \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nglass<-read.csv(url(\"http://archive.ics.uci.edu/ml/machine-learning-databases/glass/glass.data\"))\nnames(glass)<-c(\"ID\", \"RI\", \"Na\", \"Mg\", \"Al\", \"Si\", \"K\", \"Ca\", \"Ba\", \"Fe\", \"Type\")\nglass<-glass[,-1]\nglass$Type<-factor(glass$Type)\ntable(glass$Type)\nlibrary(SMVCIR)\nglass.smv<-smvcir(data = glass, group = \"Type\")\n\nglasspred<-predict(glass.smv, glass, coordinates_only = TRUE)\nglasspred$Type<-glass$Type\npred<-predict(glass.smv, glass, type = \"class\")\nconfusionMatrix(pred, glass$Type)\n\nlibrary(randomForest)\nrfMod<-randomForest(Type~., data = glass)\n\nplotcoords(x=glasspred, dimensions = 1:3,  GL = TRUE)\nplotcoords(glass.smv, dimensions = 4:8)\n\nglasscoords<-predict(glass.smv, glass, coordinates_only = TRUE)\nglasscoords$Type<-glass$Type\nplotcoords(glasscoords, dimensions = 1:3, GL = TRUE)\n\n\ncsonlynum$Dep.Var.2<-ccu$Dep.Var.2\nccu.smv<-smvcir(group = \"Dep.Var.2\", data = csonlynum[train,], test = FALSE)\nccuprob<-predict(ccu.smv, csonlynum[-train,], type = \"prob\")\n\n\n\nccupreds<-predict(ccu.smv, csonlynum[-train,], coordinates_only = TRUE)\nccupreds$Dep.Var.2<-ccu$Dep.Var.2[-train]\nplotcoords(ccupreds, dimensions = c(1:3), build_svm = TRUE, GL = TRUE)\nccuclass<-predict(ccu.smv, csonlynum[-train,], type = \"class\")\nconfusionMatrix(ccuclass, csonlynum$Dep.Var.2[-train])\n\nplotcoords(ccupreds, dimensions = 1:3, GL = TRUE, build_svm = TRUE)\n\n\n\nccugf<-grapherfunc(ccu.smv, csonlynum[-train,])\n\n\n\n\nwines<-read.csv(url(\"https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data\"), header = FALSE)\nhead(wines)\nnames(wines)<-c(alcohol, malic, )\n\n\nnpsm:::\n\ndata(\"latour\")\nstr(latour)\n\nplot(latour$year, latour$quality, type = \"l\")\n\n?fkk.test\nfkk.test(y = latour$end.of.harvest, ind = factor(latour$quality))\n\nlatour$rain<-factor(latour$rain)\nstr(latour)\n\nmod<-smvcir(\"rain\", data = latour[,c(2:4)])\n\nlibrary(npsm)\ndat <- matrix(scan(\"C:/users/dan/desktop/smvcir/threesamp.dat\",skip=4),byrow=T,ncol=2)\nRead 66 items\nresponse<-dat[,1];   indicator <- dat[,2]\nfkk.test(response,indicator)\ndatMod<-smvcir(\"indicator\", data = dat)\n\n\n\n\n",
    "created" : 1459054266466.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "111004352",
    "id" : "8278AA40",
    "lastKnownWriteTime" : 7011605692497750387,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled3"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}