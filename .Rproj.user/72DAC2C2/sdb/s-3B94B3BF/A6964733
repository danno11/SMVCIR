{
    "contents" : "\n\nlibrary(SMVCIR)\nlibrary(pROC)\nlibrary(MASS)\nlibrary(e1071)\nfunction(seed = sample(1:10000, size = 1), y = wisc$tumor, data = wisc){\n   set.seed(seed)\n}\nset.seed(4316)\nacc_mat<-matrix(NA, 10,5)\nauc_mat<-matrix(NA, 10,5)\nfor(i in 1:10){\n  ####centroid smvcir method\n  datsamp<-sample(1:nrow(wisc), replace = TRUE)\n  mod<-smvcir(group = \"tumor\", data = wisc[datsamp,], test = FALSE)\n  oob_class_preds<-predict(mod, newdata = wisc[-datsamp,], type = \"class\")\n  oob_prob_preds<-predict(mod, newdata = wisc[-datsamp,], type = \"prob\")\n  tab<-table(oob_class_preds, wisc[-datsamp,]$tumor)\n  acc_mat[i,1]<-sum(diag(tab))/sum(tab) ###centroid oob overall accuracy\n  roc1<-roc(wisc[-datsamp,]$tumor, oob_prob_preds[,2])\n  auc_mat[i,1]<-auc(roc1)\n  ####logistic smvcir method\n  pred_coords<-predict(mod, newdata = wisc, coordinates_only = TRUE)\n  pred_coords$tumor<-wisc$tumor\n  logistic_mod<-glm(tumor~.,data = pred_coords[datsamp,], family = \"binomial\")\n  glm_preds<-predict(logistic_mod, newdata = pred_coords[-datsamp,], type = \"response\")\n  classp<-ifelse(glm_preds > .5, \"malignant\", \"benign\")\n  tab2<-table(classp, pred_coords[-datsamp,]$tumor)\n  roc2<-roc(pred_coords[-datsamp,]$tumor, glm_preds)\n  auc_mat[i, 2]<-auc(roc2)\n  acc_mat[i, 2]<-sum(diag(tab2))/sum(tab2)\n  ####svm method\n  svmMod<-svm(tumor~., data = pred_coords[datsamp,], probability = TRUE)\n  ppred<-predict(svmMod, newdata = pred_coords[-datsamp,], probability = TRUE)\n  tab3<-table(ppred, pred_coords[-datsamp,]$tumor)\n  roc3<-roc(pred_coords[-datsamp,]$tumor, attr(ppred, \"probabilities\")[,2])\n  auc_mat[i, 3]<-auc(roc3)\n  acc_mat[i, 3]<-sum(diag(tab3))/sum(tab3)\n  #####logistic original coordinates\n  logistic_mod2<-glm(tumor~.,data = wisc[datsamp,], family = \"binomial\")\n  glm_preds2<-predict(logistic_mod2, newdata = wisc[-datsamp,], type = \"response\")\n  classp2<-ifelse(glm_preds2 > .5, \"malignant\", \"benign\")\n  tab22<-table(classp2, wisc[-datsamp,]$tumor)\n  roc22<-roc(wisc[-datsamp,]$tumor, glm_preds2)\n  auc_mat[i, 4]<-auc(roc22)\n  acc_mat[i, 4]<-sum(diag(tab22))/sum(tab22)\n  ####\n  ####svm original coordinates\n  svmMod2<-svm(tumor~., data = wisc[datsamp,], probability = TRUE)\n  ppred2<-predict(svmMod2, newdata = wisc[-datsamp,], probability = TRUE)\n  tab32<-table(ppred2, wisc[-datsamp,]$tumor)\n  roc32<-roc(wisc[-datsamp,]$tumor, attr(ppred2, \"probabilities\")[,2])\n  auc_mat[i, 5]<-auc(roc32)\n  acc_mat[i, 5]<-sum(diag(tab32))/sum(tab32)\n  #####\n  colnames(auc_mat)<-c(\"centroid\", \"logistic (smvcir)\", \"svm (smvcir)\", \"logistic\", \"svm\")\n  colnames(acc_mat)<-c(\"centroid\", \"logistic (smvcir)\", \"svm (smvcir)\", \"logistic\", \"svm\")\n}\nacc_mat\nauc_mat\nmean(acc_mat[,1]>acc_mat[,2]*1)\napply(auc_mat,2,mean)\napply(acc_mat, 2, mean)\n###add quiet output option for smvcir automatic output\n\n\ndims<-smvcir(\"tumor\", wisc, test = TRUE)\nplotcoords(dims, 1:3, GL = TRUE, kernel = \"radial\")\n\na<-bootit(boots = 10, groupcol = 10, dat = wisc)\npimboot<-bootit(boots = 20, seed = 11, groupcol = 9, dat = pima)\napply(pimboot$acc_mat,2,mean)\napply(pimboot$auc_mat, 2, mean)\nplot(pimboot$auc_mat[,1], pimboot$auc_mat[,5])\nabline(0,1)\n\nlibrary(SMVCIR)\nlibrary(pROC)\nlibrary(MASS)\nlibrary(e1071)\ndat<-wisc\ngroupcol<-10\nboots<-10\nbootit<-function(boots = 10, seed = sample(1:10000, size = 1), groupcol, dat){\n  set.seed(seed)\n  acc_mat<-matrix(NA, boots,8)\n  auc_mat<-matrix(NA, boots,8)\n\n  for(i in 1:boots){\n    ####centroid smvcir method\n    datsamp<-sample(1:nrow(dat), replace = TRUE)\n    mod<-smvcir(group = names(dat)[groupcol], data = dat[datsamp,], test = TRUE)\n    oob_class_preds<-predict(mod, newdata = dat[-datsamp,], type = \"class\")\n    oob_prob_preds<-predict(mod, newdata = dat[-datsamp,], type = \"prob\")\n    tab<-table(oob_class_preds, dat[-datsamp,groupcol])\n    acc_mat[i,1]<-sum(diag(tab))/sum(tab) ###centroid oob overall accuracy\n    roc1<-roc(dat[-datsamp,groupcol], oob_prob_preds[,2])\n    auc_mat[i,1]<-auc(roc1)\n    ####logistic smvcir method\n    pred_coords<-predict(mod, newdata = dat, coordinates_only = TRUE)\n    pred_coords[,groupcol]<-dat[,groupcol]\n    names(pred_coords)[groupcol]<-names(dat)[groupcol]\n    logistic_mod<-glm(as.formula(paste(names(pred_coords)[groupcol],\"~.\")), data = pred_coords[datsamp,], family = \"binomial\")\n    glm_preds<-predict(logistic_mod, newdata = pred_coords[-datsamp,], type = \"response\")\n    classp<-ifelse(glm_preds < .5, levels(pred_coords[,groupcol])[1], levels(pred_coords[,groupcol])[2])\n    tab2<-table(classp, pred_coords[-datsamp,groupcol])\n    roc2<-roc(pred_coords[-datsamp,groupcol], glm_preds)\n    auc_mat[i, 2]<-auc(roc2)\n    acc_mat[i, 2]<-sum(diag(tab2))/sum(tab2)\n    ####svm method\n    svmMod<-svm(as.formula(paste(names(pred_coords)[groupcol],\"~.\")), data = pred_coords[datsamp,], probability = TRUE)\n    ppred<-predict(svmMod, newdata = pred_coords[-datsamp,], probability = TRUE)\n    tab3<-table(ppred, pred_coords[-datsamp,groupcol])\n    roc3<-roc(pred_coords[-datsamp,groupcol], attr(ppred, \"probabilities\")[,2])\n    auc_mat[i, 3]<-auc(roc3)\n    acc_mat[i, 3]<-sum(diag(tab3))/sum(tab3)\n    #####WITH OPTIMAL DIMENSIONS SMVCIR\n    ########\n    ####centroid smvcir method\n    oob_class_preds<-predict(mod, newdata = dat[-datsamp,], type = \"class\", maxdim = mod$statdim)\n    oob_prob_preds<-predict(mod, newdata = dat[-datsamp,], type = \"prob\", maxdim = mod$statdim)\n    tab<-table(oob_class_preds, dat[-datsamp,groupcol])\n    acc_mat[i,4]<-sum(diag(tab))/sum(tab) ###centroid oob overall accuracy\n    roc1<-roc(dat[-datsamp,groupcol], oob_prob_preds[,2])\n    auc_mat[i,4]<-auc(roc1)\n    ####logistic smvcir method\n    pred_coords<-predict(mod, newdata = dat, coordinates_only = TRUE, maxdim = mod$statdim)\n    ngc<-(ncol(pred_coords)+1)\n    pred_coords[,ngc]<-dat[,groupcol]\n    names(pred_coords)[ngc]<-names(dat)[groupcol]\n    logistic_mod<-glm(as.formula(paste(names(pred_coords)[ngc],\"~.\")), data = pred_coords[datsamp,], family = \"binomial\")\n    glm_preds<-predict(logistic_mod, newdata = pred_coords[-datsamp,], type = \"response\")\n    classp<-ifelse(glm_preds < .5, levels(pred_coords[,ngc])[1], levels(pred_coords[,ngc])[2])\n    tab2<-table(classp, pred_coords[-datsamp,ngc])\n    roc2<-roc(pred_coords[-datsamp,ngc], glm_preds)\n    auc_mat[i, 5]<-auc(roc2)\n    acc_mat[i, 5]<-sum(diag(tab2))/sum(tab2)\n    ####svm method\n    svmMod<-svm(as.formula(paste(names(pred_coords)[ngc],\"~.\")), data = pred_coords[datsamp,], probability = TRUE)\n    ppred<-predict(svmMod, newdata = pred_coords[-datsamp,], probability = TRUE)\n    tab3<-table(ppred, pred_coords[-datsamp,ngc])\n    roc3<-roc(pred_coords[-datsamp,ngc], attr(ppred, \"probabilities\")[,2])\n    auc_mat[i, 6]<-auc(roc3)\n    acc_mat[i, 6]<-sum(diag(tab3))/sum(tab3)\n    #######WITH ORIGINAL COORDINATES\n    #####logistic original coordinates\n    dat[,-groupcol]<-scale(dat[-groupcol], center = TRUE, scale = TRUE) ####Advantage of centering and scaling data\n                                                                        ####for svm used later\n    logistic_mod2<-glm(as.formula(paste(names(dat)[groupcol],\"~.\")),data = dat[datsamp,], family = \"binomial\")\n    glm_preds2<-predict(logistic_mod2, newdata = dat[-datsamp,], type = \"response\")\n    classp2<-ifelse(glm_preds2 < .5,levels(dat[,groupcol])[1], levels(dat[,groupcol])[2])\n    tab22<-table(classp2, dat[-datsamp,groupcol])\n    roc22<-roc(dat[-datsamp,groupcol], glm_preds2)\n    auc_mat[i, 7]<-auc(roc22)\n    acc_mat[i, 7]<-sum(diag(tab22))/sum(tab22)\n    ####\n    ####svm original coordinates\n    svmMod2<-svm(as.formula(paste(names(dat)[groupcol],\"~.\")), data = dat[datsamp,], probability = TRUE)\n    ppred2<-predict(svmMod2, newdata = dat[-datsamp,], probability = TRUE)\n    tab32<-table(ppred2, dat[-datsamp,groupcol])\n    roc32<-roc(dat[-datsamp,groupcol], attr(ppred2, \"probabilities\")[,2])\n    auc_mat[i, 8]<-auc(roc32)\n    acc_mat[i, 8]<-sum(diag(tab32))/sum(tab32)\n  }\n  #####\n  colnames(auc_mat)<-c(\"centroid\", \"logistic (smvcir)\", \"svm (smvcir)\", \"reducedCentroid\",\n                       \"reducedlog\", \"reducedsvm\", \"logistic\", \"svm\")\n  colnames(acc_mat)<-colnames(auc_mat)\n  return(list(acc_mat = acc_mat, auc_mat = auc_mat, seed = seed))\n\n}\n\n\nwiscboot<-bootit(boots = 20, seed = 411, dat = wisc, groupcol = 10)\npimboot<-bootit(boots = 20, seed = 411, dat = pima, groupcol = 9)\nbankboot<-bootit(boots = 20, seed = 411, dat = banknote, groupcol = 7)\n\n\n\n\nx<-wisc[wisc$tumor==\"malignant\",]\ny<-wisc[wisc$tumor==\"benign\",]\n\nvar.test(x,y)\nbartlett.test(secs~tumor, data = wisc )\n\nbanknote<-read.table(\"http://www.stat.tamu.edu/~sheather/book/docs/datasets/banknote.txt\", header = TRUE, sep = \"\\t\")\nbanknote$Y<-factor(banknote$Y)\nsave(banknote, file = \"data/banknote.RData\")\nstr(banknote)\n\nlibrary(biotools)\nwi<-boxM(wisc[,-10], wisc[,10])\npim<-boxM(pima[,-9], pima[,9])\nban<-boxM(banknote[,-7], banknote[,7])\ndata(iris)\nbo<-boxM(iris[, -5], iris[, 5])\nbo$cov\nbankboot<-bootit(boots = 25, groupcol = 7, dat = banknote)\n\nbanksmv<-smvcir(\"Y\", data = banknote, test = TRUE)\nplotcoords(banksmv, dimensions = 1:3, build_svm = TRUE, kernel = \"linear\")\n\nplotcoords(banksmv, dimensions = 1:3, build_svm = TRUE, kernel = \"radial\", GL = TRUE)\n\ndata(moco)\nstr(moco)\n\nsum(bo$cov[[1]]/bo$cov[[2]])/nrow(bo$cov[[1]])^2\nsum(pim$cov[[1]]/pim$cov[[2]])/nrow(pim$cov[[1]])^2\nsum(wi$cov[[1]]/wi$cov[[2]])/nrow(wi$cov[[1]])^2\nsum(ban$cov[[1]]/ban$cov[[2]])/nrow(ban$cov[[1]])^2\n\n\n",
    "created" : 1460916540302.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3880260704",
    "id" : "A6964733",
    "lastKnownWriteTime" : 1460428701,
    "path" : "C:/Users/Dan/Desktop/smvcir/crossval_smvcir.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "type" : "r_source"
}